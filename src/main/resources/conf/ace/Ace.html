<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Editor</title>
    <style type="text/css" media="screen">
        body {
        overflow: hidden;
        }
        #editor {
        margin: 0;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        }
    </style>
</head>
<body>

<pre id="editor">
    TEST	START
	
	;2bit毎の商と余りをメモリに持つ。
	;実行命令数が最大となる被演算数nは48059
	;その時の実行命令数は105
		
	LAD	GR2,0	;商
	LAD	GR3,0	;余り
	LD	GR4,mask;mask
	LAD	GR6,0	;offset
	LD	GR1,A	;被演算数
	
For	LD	GR5,GR1
	AND	GR5,GR4			;Mask
	ADDA	GR5,GR6			;メモリへのインデックス
	ADDA	GR2,DATA1,GR5		;商
	ADDA	GR3,DATA2,GR5		;余り
	CPA	GR3,=10
	JMI	Next			
	ADDA	GR2,=1			
	SUBA	GR3,=10
	
Next	SRL	GR1,2			;次の2ビットを調べる。
	JZE	For_end
	ADDA	GR6,offset		;offsetの設定
	JUMP	For
	
For_end	RET
	
A	DC	48059
offset	DC	4
mask	DC	3
	
Data1	DC	0,0,0,0
	DC	0,0,0,1
	DC	0,1,3,4
	DC	0,6,12,19
	DC	0,25,51,76
	DC	0,102,204,307
	DC	0,409,819,1228
	DC	0,1638,3276,4915
Data2	DC	0,1,2,3
	DC	0,4,8,2
	DC	0,6,3,8
	DC	0,4,8,2
	DC	0,6,2,8
	DC	0,4,8,2
	DC	0,6,2,8
	DC	0,4,8,2
	END

    section	.text
    global main         ;must be declared for using gcc

main:	                ;tell linker entry point

	mov	edx, len	    ;message length
	mov	ecx, msg	    ;message to write
	mov	ebx, 1	        ;file descriptor (stdout)
	mov	eax, 4	        ;system call number (sys_write)
	int	0x80	        ;call kernel

	mov	eax, 1	        ;system call number (sys_exit)
	int	0x80 	        ;call kernel
	'aaaaa'
section	.data

msg	db	'Hello, world!',0xa	;our dear string
len	equ	$ - msg			;length of our dear string

}</pre>

<script src="src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/twilight");
    editor.session.setMode("ace/mode/casl2");
</script>

</body>
</html>